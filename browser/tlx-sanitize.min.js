(function(){"use strict";const tlx=this.tlx||(this.tlx={});tlx.options||(tlx.options={});tlx.options.sanitize=true;const cleaner=tlx.escape=((data,extensions={},options=cleaner.options)=>{options=Object.keys(options).reduce((accum,key)=>{if(Array.isArray(options[key])){accum[key]=(extensions[key]||[]).reduce((accum,item)=>{accum.includes(item)||accum.push(item);return accum},options[key].slice())}else if(typeof extensions[key]==="undefined"){accum[key]=options[key]}else{accum[key]=extensions[key]}return accum},{});data=options.coerce.reduce((accum,coercer)=>coercer(accum),data);if(options.accept.some(test=>test(data)))return data;if(options.reject.some(test=>test(data)))return;if(Array.isArray(data)){data.forEach((item,i)=>data[i]=cleaner(data));return data}if(data&&typeof data==="object"){for(let key in data){const cleaned=cleaner(data[key]);if(typeof cleaned==="undefined"){delete data[key]}else{data[key]=cleaned}}return data}if(typeof data==="string"){data=options.escape.reduce((accum,escaper)=>escaper(accum),data);if(options.eval){try{return cleaner(Function("return "+data).call(null))}catch(error){return data}}}return data});cleaner.extend=(extensions=>{const options=cleaner.options;cleaner.options=Object.keys(options).reduce((accum,key)=>{if(Array.isArray(options[key])){accum[key]=(extensions[key]||[]).reduce((accum,item)=>{accum.includes(item)||accum.push(item);return accum},options[key].slice())}else if(typeof extensions[key]==="undefined"){accum[key]=options[key]}else{accum[key]=extensions[key]}return accum},{})});cleaner.options={coerce:[],accept:[data=>!data||["number","boolean"].includes(typeof data)],reject:[data=>typeof data==="function",data=>typeof data==="string"&&data.match(/<\s*\?\s*.*\s*/),data=>typeof data==="string"&&data.match(/eval|alert|prompt|dialog|void|cleaner\s*\(/),data=>typeof data==="string"&&data.match(/url\s*\(/),data=>typeof data==="string"&&data.match(/console\.\s*.*\s*\(/),data=>typeof data==="string"&&data.match(/javascript:/),data=>typeof data==="string"&&data.match(/\(\s*.*\s*\)\s*.*\s*=>/),data=>typeof data==="string"&&data.match(/[Ff]unction\s*.*\s*\(\s*.*\s*\)\s*.*\s*\{\s*.*\s*\}\s*.*\s*\)\s*.*\s*\(\s*.*\s*\)/)],escape:[data=>{if(typeof data==="string"&&data[0]==="?"){const parts=data.split("&");let max=parts.length;return parts.reduce((accum,part,i)=>{const[key,value]=decodeURIComponent(part).split("="),type=typeof value,cleaned=type!=="undefined"?cleaner(value):cleaner(key);if(typeof cleaned!=="undefined"){accum+=(type!=="undefined"?`${key}=${cleaned}`:cleaned)+(i<max-1?"&":"")}else{max--}return accum},"?")}return data},data=>{if(typeof data==="string"&&data[0]!=="?"&&typeof document!=="undefined"){const div=document.createElement("div");div.appendChild(document.createTextNode(data));return div.innerHTML}return data}],eval:true};function setAttribute(name,value){const cleaned=name.indexOf("on")===0?value:cleaner(value);if(typeof cleaned!=="undefined"){this.__setAttribute__(name,cleaned)}}cleaner.protect=(el=>{if(typeof el.value!=="undefined"){const get=()=>get._value,set=value=>{const cleaned=cleaner(value);if(typeof cleaned!=="undefined"){get._value=cleaned}};get.__value=cleaner(el.value);Object.defineProperty(el,"value",{enumerable:true,configurable:true,get:get,set:set})}if(el.setAttribute!==setAttribute){Object.defineProperty(el,"__setAttribute__",{enumerbale:false,configurable:true,writable:true,value:el.setAttribute});el.setAttribute=setAttribute}for(let child of[].slice.call(el.children)){cleaner.protect(child)}return el});if(typeof document!=="undefined"){const _documentCreateElement=document.createElement.bind(document);document.createElement=function(tagName,options){return cleaner.protect(_documentCreateElement(tagName,options))}}if(typeof window!=="undefined"){if(window.prompt){const _prompt=window.prompt.bind(window);window.prompt=function(title){const input=_prompt(title),cleaned=cleaner(input);if(typeof cleaned=="undefined"){window.alert("Invalid input: "+input)}else{return cleaned}}}window.addEventListener("load",()=>{cleaner.protect(document.head);cleaner.protect(document.body)})}if(typeof module!=="undefined")module.exports=cleaner;if(typeof window!=="undefined")window.cleaner=cleaner}).call(this);