(function(){"use strict";var e,t,n;if(typeof window==="undefined"){e=require("jsdom").JSDOM;t=new e(``).window;n=(e=>e())}else{t=window;n=t.requestAnimationFrame}var r=t.document;function i(e,t,r={},o=t){Object.defineProperty(t,"view",{enumerable:false,configurable:true,writable:true,value:o});if(e.nodeName==="#text"&&t.nodeName==="#text"){if(t.data!==e.data)n(()=>t.data=e.data);return}if(e.constructor!==t.constructor||e.style.cssText!==t.style.cssText){!t.parentNode||n(()=>t.parentNode.replaceChild(e,t));return}for(const n in e){if(n[0]==="o"&&n[1]==="n"&&typeof e[n]==="function"){Object.keys(r).some(i=>{const o=r[i]+"",s=e[n]+"",a=s.substring(s.indexOf("{")+1,s.lastIndexOf("}")).trimStart().trimEnd();if(a===o){t.addEventListener(n.substring(2),r[i]);return true}})}}[].slice.call(e.attributes).forEach(r=>{const i=e.getAttribute(r.name);if(i!==t.getAttribute(r.name))n(()=>t.setAttribute(r.name,i))});[].slice.call(t.attributes).forEach(r=>{if(e.getAttribute(r.name)==null)n(()=>t.removeAttribute(r.name))});let s=t.childNodes.length-e.childNodes.length;while(s-- >0){!t.lastChild||t.removeChild(t.lastChild)}let a=[].slice.call(t.childNodes,0,e.childNodes.length);if(a.length===0){const n=t.shadowRoot;if(n)a=[].slice.call(n.childNodes,0,e.childNodes.length)}let c=[].slice.call(e.childNodes);if(c.length===0){const t=e.shadowRoot;if(t)c=[].slice.call(t.childNodes)}c.forEach((e,s)=>{if(s<a.length)i(e,a[s],r,o);else n(()=>t.appendChild(e.cloneNode(true)))})}function o(){}o.prototype=new Function;let s;const a=new Map,c=e=>{const t=e.message.indexOf("not defined");if(t>=0){const t=e.message.split(" ")[0];try{return Function(`return ${t}`)()}catch(e){return t}}},l=(e,...t)=>{if(Array.isArray(e)){e=e.reduce((n,r,i)=>n+=r+(i<e.length-1?t[i]:""),"")}return Function("model","actions","extras","with(model) { with(actions) { with(extras) { return `"+e+"`}}}")},f=(e,t)=>{t=Object.assign(e,t);Object.keys(t).forEach(n=>{if(typeof t[n]==="undefined"){delete e[n];delete t[n]}});return e},u=(e={},t={})=>{Object.keys(e).forEach(n=>{if(e[n]&&typeof e[n]==="object")u(e[n],t[n])});const n=new Proxy(e,{get(e,t){if(s){let n=a.get(e);if(!n){n={};a.set(e,n)}n[t]||(n[t]=new Set);n[t].add(s)}return e[t]},set(e,r,i){const o=t[r]||t["*"],s=e[r];if(s===i)return true;if(o){const e=Array.isArray(o)?o:[o];e.forEach(e=>t[r](s,i,r,n))}e[r]=i;const c=a.get(e);if(c&&c[r]){c[r].forEach(e=>{if(e.parentElement&&e.render)e.render();else c[r].delete(e)})}return true}});return n},d=e=>{return t=>{const n=e[t.type]||e["*"];if(n)n(t)}},p=(e,t={})=>{let{template:n,customElement:i,model:s,attributes:a,actions:c,controller:u,linkModel:d,reactive:p,lifecycle:h={}}=t;if(n&&i)throw new Error("Component can only take a template or customElement, not both");if(!i){const t=e.split("-").map(e=>`${e[0].toUpperCase()+e.substring(1)}`).join("");if(typeof n!=="function")n=l(n||"");i=Function("template","model","actions","reactive",`return class ${t} extends HTMLElement {\nconstructor() { super(); const shadow = this.attachShadow({mode: 'open'}),extras = {};\nwhile(true) {\n\ttry {\n\t\tshadow.innerHTML = template(reactive ? reactor(model) : model,actions,extras); break;\n\t} catch(e) {\n\t\tconst variable = getUndefined(e);\n\t\tif(!variable) throw e;\n\t\tmodel[variable]; // force get\n\t\textras[variable] = "";\n\t}}}}`)(n,JSON.parse(JSON.stringify(s)),c,p)}customElements.define(e,i,t.extends?{extends:t.extends}:undefined);const m=new o,g=function(t){const n=r.createElement(e),i=Object.assign({controller:u,linkModel:d,lifecycle:h},t);i.model=f(s,t.model);i.attributes=f(Object.assign({},a),t.attributes);i.actions=f(Object.assign({},c),t.actions);if(h.beforeCreate)h.beforeCreate.call(n);b(n,i);if(h.created)h.created.call(n);return n};g.constructor=o;Object.setPrototypeOf(g,m);return g},h=e=>{function t(t){Object.defineProperty(t,"stopRoute",{enumerable:false,configurable:true,writable:true,value:function(){this.routeStopped=true}});const n=t.target.href;if(n){const n=t.target,r=n.getAttribute("target")||n.view;let i=n.pathname.substring(1);if(n.protocol==="file:")i=i.substring(i.indexOf(":")+2);for(let n in e){const r=e[n];try{n=Function("return "+n)()}catch(e){}const o=typeof n,s={};if(o==="string"){const e=n.split("/"),t=i.split("/");if(e.length!==t.length)continue;if(!e.every((e,n)=>{if(e[0]===":"){s[e.substring(1)]=t[n];return true}return e===t[n]})){continue}}if(o==="string"||o==="function"&&n(i)||n.match(i)){r.call(t,s);t.preventDefault();if(t.routeStopped)break}}}}Object.defineProperty(t,"add",{enumerable:false,configurable:true,writable:true,value:(t,n)=>e[t]=n});e=Object.assign({},e);return t},b=(e,{template:n,model:o={},attributes:a={},actions:u={},controller:d,linkModel:p,lifecycle:h={},protect:b=g}={})=>{const y=typeof n;if(!n){const t=[].slice.call(e.attributes);a=Object.assign({},a);t.forEach(e=>{a[e.name]=e.value})}if(y!=="function"){if(n&&y==="object"&&n instanceof t.HTMLElement)n=n.innerHTML;n=l(n||e.innerHTML.replace(/&gt;/g,">").replace(/&lt;/g,"<"))}let v;const E=(t=o,l)=>{if(w.off||!e.parentElement)return;const d=r.createElement(e.tagName),p={},b=s;if(l)t=f(o,t);else if(t!==o)Object.assign(o,t);s=e;while(true){try{d.innerHTML=n(o,u,p);break}catch(e){const t=c(e);if(!t)throw e;o[t];p[t]=""}}s=b;if(v&&h.beforeUpdate)h.beforeUpdate.call(e);Object.keys(a).forEach(e=>{let t;while(true){try{t=Function("model","actions","extras","with(model) { with(actions) { with(extras) { return `"+a[e]+"`}}}")(o,u,p);break}catch(e){const t=c(e);if(!t)throw e;o[t];p[t]=""}}d.setAttribute(e,t)});i(d,e,u);if(v&&h.updated)h.updated.call(e)},O=(e,...t)=>{return n=>{const i=e.split(".");let s=i.pop(),a,c=o;while(a=i.shift()){c=c[a];if(c===undefined){c[a]={}}}c[s]=n.target.value;t.forEach(e=>r.querySelectorAll(e).forEach(e=>!e.render||e.render()))}};if(h.beforeMount)h.beforeMount.call(e);E(o);v=true;if(h.mounted)h.mounted.call(e);if(d){let{handleEvent:t,events:n,options:r=false}=d;if(typeof d==="function")t=d;if(n){n.forEach(n=>e.addEventListener(n,t,r))}else{for(const t in e){if(t[0]==="o"&&t[1]==="n")e.addEventListener(t.substring(2),d,r)}}}const j=[].slice.call(e.querySelectorAll("input"));if(e instanceof t.HTMLInputElement)j.push(e);j.forEach(e=>{if(b||e.hasAttribute("protect")){const t=e.setAttribute;let n=e.getAttribute("value");e.setAttribute=function(e,r){if((b||this.hasAttribute("protect"))&&e==="value"&&r){r=m(r);if(r===undefined){r=typeof violated==="function"?violated(r):n}}n=r;t.call(this,e,r)};e.addEventListener("change",e=>{const t={enumerable:true,configurable:true,writable:false};t.value=new Proxy(e.target,{get(e,t){let r=e[t];if(t==="value"&&r){r=m(r);if(r===undefined){r=typeof violated==="function"?violated(r):n}}n=r;return r}});Object.defineProperty(e,"target",t)})}});if(p){j.forEach(e=>e.addEventListener("change",e=>O(e.target.name)(e),false))}Object.defineProperty(e,"render",{enumerable:false,configurable:true,writable:true,value:E});Object.defineProperty(e,"linkModel",{enumerable:false,configurable:true,writable:true,value:O});return e},m=(e,t=m.options)=>{e=t.coerce.reduce((e,t)=>t(e),e);if(t.accept.some(t=>t(e)))return e;if(t.reject.some(t=>t(e)))return;if(Array.isArray(e)){e.forEach((t,n)=>e[n]=m(e));return e}if(e&&typeof e==="object"){for(let t in e){const n=m(e[t]);if(typeof n==="undefined"){delete e[t]}else{e[t]=n}}return e}if(typeof e==="string"){e=t.escape.reduce((e,t)=>t(e),e);if(t.eval){try{return m(Function("return "+e).call(null))}catch(t){return e}}}return e};m.options={coerce:[],accept:[e=>!e||["number","boolean"].includes(typeof e)],reject:[e=>typeof e==="function",e=>typeof e==="string"&&e.match(/<\s*\?\s*.*\s*/),e=>typeof e==="string"&&e.match(/eval|alert|prompt|dialog|void|clean\s*\(/),e=>typeof e==="string"&&e.match(/url\s*\(/),e=>typeof e==="string"&&e.match(/console\.\s*.*\s*\(/),e=>typeof e==="string"&&e.match(/javascript:/),e=>typeof e==="string"&&e.match(/\(\s*.*\s*\)\s*.*\s*=>/),e=>typeof e==="string"&&e.match(/[Ff]unction\s*.*\s*\(\s*.*\s*\)\s*.*\s*\{\s*.*\s*\}\s*.*\s*\)\s*.*\s*\(\s*.*\s*\)/)],escape:[e=>{if(typeof e==="string"&&e[0]==="?"){const t=e.split("&");let n=t.length;return t.reduce((e,t,r)=>{const[i,o]=decodeURIComponent(t).split("="),s=typeof o,a=s!=="undefined"?m(o):m(i);if(typeof a!=="undefined"){e+=(s!=="undefined"?`${i}=${a}`:a)+(r<n-1?"&":"")}else{n--}return e},"?")}return e},e=>{if(typeof e==="string"&&e[0]!=="?"&&typeof r!=="undefined"){const t=r.createElement("div");t.appendChild(r.createTextNode(e));return t.innerHTML}return e}],eval:true};let g;const y=(e=window,t=(()=>""))=>{if(typeof window!=="undefined"&&window.prompt&&e===window){const e=window.prompt.bind(window);window.prompt=function(t){const n=e(t),r=m(n);if(typeof r=="undefined"){window.alert("Invalid input: "+n)}else{return r}};g=true;return}return e};const w={component:p,reactor:u,view:b,router:h,handlers:d,escape:m,protect:y,JSDOM:e};if(typeof module!=="undefined")module.exports=w;if(typeof window!=="undefined")window.tlx=w}).call(this);